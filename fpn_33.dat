 
# This implementation of IEEE 33 distribution radial test system has been implemented in 3 phase-system
# The modifications ommits :
# 1. transformer HV to MV - usually from subtransmission
#    to medium voltage level.
# 2. The equivalent thevenin takes the medium voltage level 12.66kv 
#    rather than the HV side
# 3. the transformer connected from MV-LV are ommitted, and load is directly connected at 12.66kV voltage level
# 4. a switch element is ignored

# All in all, it works perfect to curtailment generation with two-way conversation 
# between OpenDSS and this model in AMPL.


param vb    := 12.66;
param SE    := 1;


param factor_load:= 0.89;
#param OM_PV:= 0.001;# O&M cost (US$/kWh) $4
param OM_PV:= 0.0004;# O&M cost (US$/kWh) $4

#param fem_pv:= 0.00584; # tons/MWh for PV units #0
param fem_pv:= 0.0584; # tons/MWh for PV units #0

#param fem_se:=0.5600;# tons/MWh for substation
param fem_se:=0.56;# tons/MWh for substation

param COST_emission:=40;# $/tons # 40
#param CENER    := 0.1;# cost of substation energy ($/kWh)
param CENER    := 0.1;# cost of substation energy ($/kWh)



param: N: Vmin	Vmax:=
1	0.9	1.05
2	0.9	1.05
3	0.9	1.05
4	0.9	1.05
5	0.9	1.05
6	0.9	1.05
7	0.9	1.05
8	0.9	1.05
9	0.9	1.05
10	0.9	1.05
11	0.9	1.05
12	0.9	1.05
13	0.9	1.05
14	0.9	1.05
15	0.9	1.05
16	0.9	1.05
17	0.9	1.05
18	0.9	1.05
19	0.9	1.05
20	0.9	1.05
21	0.9	1.05
22	0.9	1.05
23	0.9	1.05
24	0.9	1.05
25	0.9	1.05
26	0.9	1.05
27	0.9	1.05
28	0.9	1.05
29	0.9	1.05
30	0.9	1.05
31	0.9	1.05
32	0.9	1.05
33	0.9	1.05
;


param: H :  hours factor_gen	:=
        1	  1    1.00

		;

param: G:	pdgmax :=
     18	2149.763
	 30	0.694
     22	743.876
	 25	764.877
     14	0.686
	 33	736.646
;


param: L: 		at Imax:=
1	2	0	500
2	3	0	500
3	4	0	500
4	5	0	500
5	6	0	500
6	7	0	500
7	8	0	500
8	9	0	500
9	10	0	500
10	11	0	500
11	12	0	500
12	13	0	500
13	14	0	500
14	15	0	500
15	16	0	500
16	17	0	500
17	18	0	500
2	19	0	500
19	20	0	500
20	21	0	500
21	22	0	500
3	23	0	500
23	24	0	500
24	25	0	500
6	26	0	500
26	27	0	500
27	28	0	500
28	29	0	500
29	30	0	500
30	31	0	500
31	32	0	500
32	33	0	500


;



# This can be obtained directly from OpenDSS data of line parameters
# However, the order received in AMPL data format makes the process tedious for cp and rp parameters
# One easy way is to create a code-line to automate this process extracting data 
# from OpenDSS and directly create this fpn.dat file.

#cmatriz (nanofaradios/kft) multiplicado pela longitude (kft)

param cp: 			1				2				3				4				5				6				7					8					9	:=
1	2	0	0	0	0	0	0	0	0	0
2	3	0	0	0	0	0	0	0	0	0
3	4	0	0	0	0	0	0	0	0	0
4	5	0	0	0	0	0	0	0	0	0
5	6	0	0	0	0	0	0	0	0	0
6	7	0	0	0	0	0	0	0	0	0
7	8	0	0	0	0	0	0	0	0	0
8	9	0	0	0	0	0	0	0	0	0
9	10	0	0	0	0	0	0	0	0	0
10	11	0	0	0	0	0	0	0	0	0
11	12	0	0	0	0	0	0	0	0	0
12	13	0	0	0	0	0	0	0	0	0
13	14	0	0	0	0	0	0	0	0	0
14	15	0	0	0	0	0	0	0	0	0
15	16	0	0	0	0	0	0	0	0	0
16	17	0	0	0	0	0	0	0	0	0
17	18	0	0	0	0	0	0	0	0	0
2	19	0	0	0	0	0	0	0	0	0
19	20	0	0	0	0	0	0	0	0	0
20	21	0	0	0	0	0	0	0	0	0
21	22	0	0	0	0	0	0	0	0	0
3	23	0	0	0	0	0	0	0	0	0
23	24	0	0	0	0	0	0	0	0	0
24	25	0	0	0	0	0	0	0	0	0
6	26	0	0	0	0	0	0	0	0	0
26	27	0	0	0	0	0	0	0	0	0
27	28	0	0	0	0	0	0	0	0	0
28	29	0	0	0	0	0	0	0	0	0
29	30	0	0	0	0	0	0	0	0	0
30	31	0	0	0	0	0	0	0	0	0
31	32	0	0	0	0	0	0	0	0	0
32	33	0	0	0	0	0	0	0	0	0


;

param Rp:		1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	:=
#			 	  Ra		  Xa		  Rab		  Xab		  Rac	      Xac		  Rba		  Xba		  Rb		  Xb		  Rbc			Xbc		  Rca	      Xca		  Rcb			Xcb		  Rc		  Xc	 

1	2	0.120933333	0.166233333	0.028733333	0.119233333	0.028733333	0.119233333	0.028733333	0.119233333	0.120933333	0.166233333	0.028733333	0.119233333	0.028733333	0.119233333	0.028733333	0.119233333	0.120933333	0.166233333
2	3	0.388133333	0.3023	-0.104866667	0.0512	-0.104866667	0.0512	-0.104866667	0.0512	0.388133333	0.3023	-0.104866667	0.0512	-0.104866667	0.0512	-0.104866667	0.0512	0.388133333	0.3023
3	4	0.303466667	0.259166667	-0.062533333	0.072766667	-0.062533333	0.072766667	-0.062533333	0.072766667	0.303466667	0.259166667	-0.062533333	0.072766667	-0.062533333	0.072766667	-0.062533333	0.072766667	0.303466667	0.259166667
4	5	0.313533333	0.2643	-0.067566667	0.0702	-0.067566667	0.0702	-0.067566667	0.0702	0.313533333	0.2643	-0.067566667	0.0702	-0.067566667	0.0702	-0.067566667	0.0702	0.313533333	0.2643
5	6	0.605466667	0.606233333	-0.213533333	-0.100766667	-0.213533333	-0.100766667	-0.213533333	-0.100766667	0.605466667	0.606233333	-0.213533333	-0.100766667	-0.213533333	-0.100766667	-0.213533333	-0.100766667	0.605466667	0.606233333
6	7	0.184266667	0.547433333	-0.002933333	-0.071366667	-0.002933333	-0.071366667	-0.002933333	-0.071366667	0.184266667	0.547433333	-0.002933333	-0.071366667	-0.002933333	-0.071366667	-0.002933333	-0.071366667	0.184266667	0.547433333
7	8	0.533733333	0.291633333	-0.177666667	0.056533333	-0.177666667	0.056533333	-0.177666667	0.056533333	0.533733333	0.291633333	-0.177666667	0.056533333	-0.177666667	0.056533333	-0.177666667	0.056533333	0.533733333	0.291633333
8	9	0.746133333	0.628233333	-0.283866667	-0.111766667	-0.283866667	-0.111766667	-0.283866667	-0.111766667	0.746133333	0.628233333	-0.283866667	-0.111766667	-0.283866667	-0.111766667	-0.283866667	-0.111766667	0.746133333	0.628233333
9	10	0.755466667	0.628233333	-0.288533333	-0.111766667	-0.288533333	-0.111766667	-0.288533333	-0.111766667	0.755466667	0.628233333	-0.288533333	-0.111766667	-0.288533333	-0.111766667	-0.288533333	-0.111766667	0.755466667	0.628233333
10	11	0.190533333	0.178233333	-0.006066667	0.113233333	-0.006066667	0.113233333	-0.006066667	0.113233333	0.190533333	0.178233333	-0.006066667	0.113233333	-0.006066667	0.113233333	-0.006066667	0.113233333	0.190533333	0.178233333
11	12	0.309066667	0.217433333	-0.065333333	0.093633333	-0.065333333	0.093633333	-0.065333333	0.093633333	0.309066667	0.217433333	-0.065333333	0.093633333	-0.065333333	0.093633333	-0.065333333	0.093633333	0.309066667	0.217433333
12	13	1.038133333	0.9049	-0.429866667	-0.2501	-0.429866667	-0.2501	-0.429866667	-0.2501	1.038133333	0.9049	-0.429866667	-0.2501	-0.429866667	-0.2501	-0.429866667	-0.2501	1.038133333	0.9049
13	14	0.420533333	0.610166667	-0.121066667	-0.102733333	-0.121066667	-0.102733333	-0.121066667	-0.102733333	0.420533333	0.610166667	-0.121066667	-0.102733333	-0.121066667	-0.102733333	-0.121066667	-0.102733333	0.420533333	0.610166667
14	15	0.453466667	0.485566667	-0.137533333	-0.040433333	-0.137533333	-0.040433333	-0.137533333	-0.040433333	0.453466667	0.485566667	-0.137533333	-0.040433333	-0.137533333	-0.040433333	-0.137533333	-0.040433333	0.453466667	0.485566667
15	16	0.557	0.498233333	-0.1893	-0.046766667	-0.1893	-0.046766667	-0.1893	-0.046766667	0.557	0.498233333	-0.1893	-0.046766667	-0.1893	-0.046766667	-0.1893	-0.046766667	0.557	0.498233333
16	17	0.9188	1.282233333	-0.3702	-0.438766667	-0.3702	-0.438766667	-0.3702	-0.438766667	0.9188	1.282233333	-0.3702	-0.438766667	-0.3702	-0.438766667	-0.3702	-0.438766667	0.9188	1.282233333
17	18	0.547466667	0.517566667	-0.184533333	-0.056433333	-0.184533333	-0.056433333	-0.184533333	-0.056433333	0.547466667	0.517566667	-0.184533333	-0.056433333	-0.184533333	-0.056433333	-0.184533333	-0.056433333	0.547466667	0.517566667
2	19	0.1688	0.239233333	0.0048	0.082733333	0.0048	0.082733333	0.0048	0.082733333	0.1688	0.239233333	0.0048	0.082733333	0.0048	0.082733333	0.0048	0.082733333	0.1688	0.239233333
19	20	1.062266667	1.0385	-0.441933333	-0.3169	-0.441933333	-0.3169	-0.441933333	-0.3169	1.062266667	1.0385	-0.441933333	-0.3169	-0.441933333	-0.3169	-0.441933333	-0.3169	1.062266667	1.0385
20	21	0.332466667	0.453833333	-0.077033333	-0.024566667	-0.077033333	-0.024566667	-0.077033333	-0.024566667	0.332466667	0.453833333	-0.077033333	-0.024566667	-0.077033333	-0.024566667	-0.077033333	-0.024566667	0.332466667	0.453833333
21	22	0.532066667	0.759766667	-0.176833333	-0.177533333	-0.176833333	-0.177533333	-0.176833333	-0.177533333	0.532066667	0.759766667	-0.176833333	-0.177533333	-0.176833333	-0.177533333	-0.176833333	-0.177533333	0.532066667	0.759766667
3	23	0.360266667	0.340433333	-0.090933333	0.032133333	-0.090933333	0.032133333	-0.090933333	0.032133333	0.360266667	0.340433333	-0.090933333	0.032133333	-0.090933333	0.032133333	-0.090933333	0.032133333	0.360266667	0.340433333
23	24	0.658133333	0.607633333	-0.239866667	-0.101466667	-0.239866667	-0.101466667	-0.239866667	-0.101466667	0.658133333	0.607633333	-0.239866667	-0.101466667	-0.239866667	-0.101466667	-0.239866667	-0.101466667	0.658133333	0.607633333
24	25	0.6568	0.6023	-0.2392	-0.0988	-0.2392	-0.0988	-0.2392	-0.0988	0.6568	0.6023	-0.2392	-0.0988	-0.2392	-0.0988	-0.2392	-0.0988	0.6568	0.6023
6	26	0.1948	0.203833333	-0.0082	0.100433333	-0.0082	0.100433333	-0.0082	0.100433333	0.1948	0.203833333	-0.0082	0.100433333	-0.0082	0.100433333	-0.0082	0.100433333	0.1948	0.203833333
26	27	0.248933333	0.231366667	-0.035266667	0.086666667	-0.035266667	0.086666667	-0.035266667	0.086666667	0.248933333	0.231366667	-0.035266667	0.086666667	-0.035266667	0.086666667	-0.035266667	0.086666667	0.248933333	0.231366667
27	28	0.765466667	0.757366667	-0.293533333	-0.176333333	-0.293533333	-0.176333333	-0.293533333	-0.176333333	0.765466667	0.757366667	-0.293533333	-0.176333333	-0.293533333	-0.176333333	-0.293533333	-0.176333333	0.765466667	0.757366667
28	29	0.5956	0.601966667	-0.2086	-0.098633333	-0.2086	-0.098633333	-0.2086	-0.098633333	0.5956	0.601966667	-0.2086	-0.098633333	-0.2086	-0.098633333	-0.2086	-0.098633333	0.5956	0.601966667
29	30	0.3978	0.307233333	-0.1097	0.048733333	-0.1097	0.048733333	-0.1097	0.048733333	0.3978	0.307233333	-0.1097	0.048733333	-0.1097	0.048733333	-0.1097	0.048733333	0.3978	0.307233333
30	31	0.709066667	0.7769	-0.265333333	-0.1861	-0.265333333	-0.1861	-0.265333333	-0.1861	0.709066667	0.7769	-0.265333333	-0.1861	-0.265333333	-0.1861	-0.265333333	-0.1861	0.709066667	0.7769
31	32	0.266466667	0.376166667	-0.044033333	0.014266667	-0.044033333	0.014266667	-0.044033333	0.014266667	0.266466667	0.376166667	-0.044033333	0.014266667	-0.044033333	0.014266667	-0.044033333	0.014266667	0.266466667	0.376166667
32	33	0.2868	0.488366667	-0.0542	-0.041833333	-0.0542	-0.041833333	-0.0542	-0.041833333	0.2868	0.488366667	-0.0542	-0.041833333	-0.0542	-0.041833333	-0.0542	-0.041833333	0.2868	0.488366667


;


param B:		1	2	3	:=
1	2	0	0	0
2	3	0	0	0
3	4	0	0	0
4	5	0	0	0
5	6	0	0	0
6	7	0	0	0
7	8	0	0	0
8	9	0	0	0
9	10	0	0	0
10	11	0	0	0
11	12	0	0	0
12	13	0	0	0
13	14	0	0	0
14	15	0	0	0
15	16	0	0	0
16	17	0	0	0
17	18	0	0	0
2	19	0	0	0
19	20	0	0	0
20	21	0	0	0
21	22	0	0	0
3	23	0	0	0
23	24	0	0	0
24	25	0	0	0
6	26	0	0	0
26	27	0	0	0
27	28	0	0	0
28	29	0	0	0
29	30	0	0	0
30	31	0	0	0
31	32	0	0	0
32	33	0	0	0


;
param Pd: 1 	2	   3	:=
1	0	0	0
2	33.33333333	33.33333333	33.33333333
3	30	30	30
4	40	40	40
5	20	20	20
6	20	20	20
7	66.66666667	66.66666667	66.66666667
8	66.66666667	66.66666667	66.66666667
9	20	20	20
10	20	20	20
11	15	15	15
12	20	20	20
13	20	20	20
14	40	40	40
15	20	20	20
16	20	20	20
17	20	20	20
18	140.619 140.619 140.619
19	30	30	30
20	30	30	30
21	30	30	30
22	141.413 141.413 141.413
23	30	30	30
24	140	140	140
25	252.993 252.993 252.993
26	20	20	20
27	20	20	20
28	20	20	20
29	40	40	40
30	66.66666667	66.66666667	66.66666667
31	50	50	50
32	70	70	70
33	133.917 133.917 133.917


;

param Qd: 1 	2	   3	:=
1	0	0	0
2	20	20	20
3	13.33333333	13.33333333	13.33333333
4	26.66666667	26.66666667	26.66666667
5	10	10	10
6	6.666666667	6.666666667	6.666666667
7	33.33333333	33.33333333	33.33333333
8	33.33333333	33.33333333	33.33333333
9	6.666666667	6.666666667	6.666666667
10	6.666666667	6.666666667	6.666666667
11	10	10	10
12	11.66666667	11.66666667	11.66666667
13	11.66666667	11.66666667	11.66666667
14	26.66666667	26.66666667	26.66666667
15	3.333333333	3.333333333	3.333333333
16	6.666666667	6.666666667	6.666666667
17	6.666666667	6.666666667	6.666666667
18	13.33333333	13.33333333	13.33333333
19	13.33333333	13.33333333	13.33333333
20	13.33333333	13.33333333	13.33333333
21	13.33333333	13.33333333	13.33333333
22	13.33333333	13.33333333	13.33333333
23	16.66666667	16.66666667	16.66666667
24	66.66666667	66.66666667	66.66666667
25	66.66666667	66.66666667	66.66666667
26	8.333333333	8.333333333	8.333333333
27	8.333333333	8.333333333	8.333333333
28	6.666666667	6.666666667	6.666666667
29	23.33333333	23.33333333	23.33333333
30	200	200	200
31	23.33333333	23.33333333	23.33333333
32	33.33333333	33.33333333	33.33333333
33	13.33333333	13.33333333	13.33333333

;

